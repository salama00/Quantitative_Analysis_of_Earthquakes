# Section 1: Frequency of Aftershocks per Day

The data downloaded from IRIS: Wilber 3 (https://ds.iris.edu/wilber3) contained the date, latitude (deg), longitude (deg), depth (km), and magnitude of each aftershock. I chose the initial time to be the event time of the 7.8 magnitude earthquake, which occurs at 02/06/2023 UTC 01:17:34. The time of each event is in reference to this date. To parse through the file I wrote code in python (convert_data_format.py) that reads the downloaded file and writes a new file containing the time (seconds), latitude (deg), longitude (deg), and depth (km) which is easoly read by MATLAB. The reason for this is because it is easier to deal with dates in Python than in MATLAB. I did not include the magnitudes as it is irrelevant to this study. 

The first section of the MATLAB script (main.m) computes the number of aftershocks that occur each day since the major earthquake. There are 73 days in the data file, so there are 73 frequencies. The problem is considered linear and so is modeled by matrix multiplication. The L1, L2, and L infinity norms can then be applied. The function fminsearch is used to find the minimum of L1 and L infinity. The minimum of the L2 norm is found using the function linsolve. The model parameters of each fit is displayed in the results section along with a plot containing the predicted frequencies from each fit and observed frequencies. This is done for $p = 0.5, 1, 2$.

# Section 2: Geographic Distribution of Aftershocks

The second section of the script analyzes the spread across the aftershocks, the covariance matrix of the positions of these aftershocks will be calculated. Before computing the covariance matrix the positions are converted to kilometers. One degree of latitude can be found by multiplying the radius of the Earth (6371 km) by pi/180 which gives 111 km per degree of latitude. The average latitude at which the aftershocks occurs is 37 degrees. One degree of longitude at latitude 37 degrees is $6371\cos(37\degree) \approx 87 \text{km}$. Once all the positions are in kilometers the mean is subtracted so that each position is centered around zero. The Eigenvalues and Eigenvectors of the covariance matrix is calculated. The eigenvalues give the amount of spread and the eigenvectors give the direction of spread. The directions of spread, scaled according to their magnitude of spread, is then plotted on top of the aftershocks along with a map.
